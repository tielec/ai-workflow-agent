# è¦ä»¶å®šç¾©æ›¸ - Issue #10: Git ã‚³ãƒŸãƒƒãƒˆé »åº¦ã¨ãƒ¬ã‚¸ãƒ¥ãƒ¼ãƒ ç²’åº¦ã®æ”¹å–„

## 0. Planning Document ã®ç¢ºèª

Planning Phase ã§ç­–å®šã•ã‚ŒãŸä»¥ä¸‹ã®æˆ¦ç•¥ã‚’è¸ã¾ãˆã¦è¦ä»¶å®šç¾©ã‚’å®Ÿæ–½ã—ã¾ã™ï¼š

### å®Ÿè£…æˆ¦ç•¥
- **EXTEND**: æ—¢å­˜ã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚¤ãƒ³ãƒ•ãƒ©ï¼ˆBasePhaseã€MetadataManagerã€GitManagerï¼‰ã‚’æ‹¡å¼µ
- æ–°è¦ã‚¯ãƒ©ã‚¹ã§ã¯ãªãã€æ—¢å­˜ã‚¯ãƒ©ã‚¹ã«ã‚¹ãƒ†ãƒƒãƒ—ç®¡ç†æ©Ÿèƒ½ã‚’è¿½åŠ 

### ãƒ†ã‚¹ãƒˆæˆ¦ç•¥
- **UNIT_INTEGRATION**: ã‚¹ãƒ†ãƒƒãƒ—ç®¡ç†æ©Ÿèƒ½ã®å˜ä½“ãƒ†ã‚¹ãƒˆã¨å®Ÿéš›ã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å®Ÿè¡Œã§ã®çµ±åˆãƒ†ã‚¹ãƒˆ

### ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰æˆ¦ç•¥
- **BOTH_TEST**: æ—¢å­˜ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®æ‹¡å¼µã¨æ–°è¦ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆ

### è¦‹ç©ã‚‚ã‚Šå·¥æ•°
- **20~28æ™‚é–“**ï¼ˆ8ãƒ•ã‚§ãƒ¼ã‚ºï¼‰

### ãƒªã‚¹ã‚¯è©•ä¾¡
- **é«˜**: æ—¢å­˜ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã¸ã®å½±éŸ¿ã€CI/CDç’°å¢ƒå¯¾å¿œã€ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³

---

## 1. æ¦‚è¦

### èƒŒæ™¯

ç¾åœ¨ã®AI Workflowã¯ã€å„ãƒ•ã‚§ãƒ¼ã‚ºï¼ˆplanningã€requirementsã€designãªã©ï¼‰ã®å®Œäº†å¾Œã«1å›ã ã‘Gitã‚³ãƒŸãƒƒãƒˆã‚’å®Ÿè¡Œã—ã€ãƒ¬ã‚¸ãƒ¥ãƒ¼ãƒ æ©Ÿèƒ½ã‚‚ãƒ•ã‚§ãƒ¼ã‚ºå˜ä½ã§å‹•ä½œã—ã¾ã™ã€‚ã“ã®ç²’åº¦ã®ç²—ã•ã«ã‚ˆã‚Šã€ä»¥ä¸‹ã®éåŠ¹ç‡ãŒç™ºç”Ÿã—ã¦ã„ã¾ã™ï¼š

1. **Reviewå¤±æ•—æ™‚ã®ç„¡é§„ãªå†å®Ÿè¡Œ**: execute()ã§15åˆ†ã‹ã‘ã¦æˆæœç‰©ã‚’ç”Ÿæˆã—ãŸå¾Œã€review()ã§å¤±æ•—ã™ã‚‹ã¨ã€ãƒ¬ã‚¸ãƒ¥ãƒ¼ãƒ æ™‚ã«execute()ã‹ã‚‰å†å®Ÿè¡Œã•ã‚Œã‚‹
2. **Reviseå¤±æ•—æ™‚ã®å¤§ããªãƒ­ã‚¹**: Implementation Phaseãªã©ã§execute()ï¼ˆ30åˆ†ï¼‰ã¨review()ï¼ˆ5åˆ†ï¼‰ãŒæˆåŠŸå¾Œã€revise()ã§å¤±æ•—ã™ã‚‹ã¨å…¨ä½“ã‚’å†å®Ÿè¡Œ
3. **CI/CDç’°å¢ƒã§ã®é«˜ã‚³ã‚¹ãƒˆ**: Jenkinsç­‰ã®CIç’°å¢ƒã§ã¯å„ãƒ“ãƒ«ãƒ‰ã§ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ãŒãƒªã‚»ãƒƒãƒˆã•ã‚Œã€ãƒ•ã‚§ãƒ¼ã‚ºå˜ä½ã®å†å®Ÿè¡Œã¯ãƒˆãƒ¼ã‚¯ãƒ³æ¶ˆè²»é‡ã¨å®Ÿè¡Œæ™‚é–“ã‚’å¤§å¹…ã«å¢—åŠ ã•ã›ã‚‹

### ç›®çš„

execute / review / revise ã®å„ã‚¹ãƒ†ãƒƒãƒ—å¾Œã«Gitã‚³ãƒŸãƒƒãƒˆï¼†ãƒ—ãƒƒã‚·ãƒ¥ã‚’å®Ÿè¡Œã—ã€ã‚¹ãƒ†ãƒƒãƒ—å˜ä½ã§ã®ãƒ¬ã‚¸ãƒ¥ãƒ¼ãƒ ã‚’å¯èƒ½ã«ã™ã‚‹ã“ã¨ã§ã€ä»¥ä¸‹ã‚’å®Ÿç¾ã—ã¾ã™ï¼š

1. **å®Ÿè¡Œæ™‚é–“ã®å‰Šæ¸›**: å¤±æ•—ã—ãŸã‚¹ãƒ†ãƒƒãƒ—ã®ã¿ã‚’å†å®Ÿè¡Œã™ã‚‹ã“ã¨ã§ã€ç„¡é§„ãªå‡¦ç†ã‚’æ’é™¤
2. **ã‚³ã‚¹ãƒˆå‰Šæ¸›**: Claude APIå‘¼ã³å‡ºã—ã®é‡è¤‡å®Ÿè¡Œã‚’é˜²ãã€ãƒˆãƒ¼ã‚¯ãƒ³æ¶ˆè²»é‡ã‚’æœ€å°åŒ–
3. **CI/CDåŠ¹ç‡åŒ–**: Jenkinsç­‰ã®ç’°å¢ƒã§ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ãƒªã‚»ãƒƒãƒˆå¾Œã‚‚ã€ãƒªãƒ¢ãƒ¼ãƒˆã‹ã‚‰æœ€æ–°çŠ¶æ…‹ã‚’å–å¾—ã—ã¦é©åˆ‡ãªã‚¹ãƒ†ãƒƒãƒ—ã‹ã‚‰å†é–‹

### ãƒ“ã‚¸ãƒã‚¹ä¾¡å€¤

- **é–‹ç™ºè€…ä½“é¨“ã®å‘ä¸Š**: ãƒ¬ã‚¸ãƒ¥ãƒ¼ãƒ æ™‚ã®å¾…ã¡æ™‚é–“çŸ­ç¸®ï¼ˆæœ€å¤§30åˆ†ä»¥ä¸Šã®å‰Šæ¸›è¦‹è¾¼ã¿ï¼‰
- **é‹ç”¨ã‚³ã‚¹ãƒˆã®å‰Šæ¸›**: APIå‘¼ã³å‡ºã—å›æ•°ã®å‰Šæ¸›ã«ã‚ˆã‚‹ç›´æ¥çš„ãªã‚³ã‚¹ãƒˆå‰Šæ¸›
- **CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã®å®‰å®šåŒ–**: éƒ¨åˆ†çš„ãªå¤±æ•—ã‹ã‚‰ã®é«˜é€Ÿãƒªã‚«ãƒãƒªãƒ¼

### æŠ€è¡“çš„ä¾¡å€¤

- **ç²’åº¦ã®ç´°åˆ†åŒ–**: ãƒ•ã‚§ãƒ¼ã‚ºå˜ä½ã‹ã‚‰ã‚¹ãƒ†ãƒƒãƒ—å˜ä½ã¸ã®é€²åŒ–
- **ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã®å……å®Ÿ**: current_stepã€completed_stepsã«ã‚ˆã‚‹è©³ç´°ãªçŠ¶æ…‹ç®¡ç†
- **ãƒªãƒ¢ãƒ¼ãƒˆåŒæœŸã®å¼·åŒ–**: CIç’°å¢ƒã§ã®ãƒªãƒ¢ãƒ¼ãƒˆãƒ–ãƒ©ãƒ³ãƒã¨ã®é€£æºå¼·åŒ–

---

## 2. æ©Ÿèƒ½è¦ä»¶

### FR-1: ã‚¹ãƒ†ãƒƒãƒ—å˜ä½ã®Gitã‚³ãƒŸãƒƒãƒˆï¼†ãƒ—ãƒƒã‚·ãƒ¥

**å„ªå…ˆåº¦**: é«˜

**èª¬æ˜**: executeã€reviewã€reviseã®å„ã‚¹ãƒ†ãƒƒãƒ—å®Œäº†å¾Œã«ã€è‡ªå‹•çš„ã«Gitã‚³ãƒŸãƒƒãƒˆï¼†ãƒ—ãƒƒã‚·ãƒ¥ã‚’å®Ÿè¡Œã™ã‚‹ã€‚

**è©³ç´°ä»•æ§˜**:

1. **ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å½¢å¼**:
   ```
   [ai-workflow] Phase {phase_number} ({phase_name}) - {step} completed

   Issue: #{issue_number}
   Phase: {phase_number} ({phase_name})
   Step: {step}
   Status: completed

   Auto-generated by AI Workflow
   ```

2. **ã‚³ãƒŸãƒƒãƒˆå¯¾è±¡**:
   - ã‚¹ãƒ†ãƒƒãƒ—ã®æˆæœç‰©ï¼ˆoutput/ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªé…ä¸‹ï¼‰
   - ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ï¼ˆmetadata.jsonï¼‰
   - ã‚¹ãƒ†ãƒƒãƒ—ã®ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆexecute/ã€review/ã€revise/ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªé…ä¸‹ï¼‰

3. **ãƒ—ãƒƒã‚·ãƒ¥å‹•ä½œ**:
   - ã‚³ãƒŸãƒƒãƒˆæˆåŠŸå¾Œã€å³åº§ã«ãƒªãƒ¢ãƒ¼ãƒˆãƒ–ãƒ©ãƒ³ãƒã¸ãƒ—ãƒƒã‚·ãƒ¥
   - ãƒ—ãƒƒã‚·ãƒ¥å¤±æ•—æ™‚ã¯æœ€å¤§3å›ãƒªãƒˆãƒ©ã‚¤ï¼ˆæ—¢å­˜ã®pushToRemote()æ©Ÿèƒ½ã‚’æ´»ç”¨ï¼‰
   - 3å›ã®ãƒªãƒˆãƒ©ã‚¤ã§ã‚‚å¤±æ•—ã—ãŸå ´åˆã€ã‚¹ãƒ†ãƒƒãƒ—ã¯æœªå®Œäº†ã¨ã—ã¦è¨˜éŒ²

4. **å®Ÿè¡Œã‚¿ã‚¤ãƒŸãƒ³ã‚°**:
   - execute()ãƒ¡ã‚½ãƒƒãƒ‰å®Œäº†å¾Œ
   - review()ãƒ¡ã‚½ãƒƒãƒ‰å®Œäº†å¾Œï¼ˆãƒ¬ãƒ“ãƒ¥ãƒ¼ãŒå®Ÿæ–½ã•ã‚Œã‚‹å ´åˆï¼‰
   - revise()ãƒ¡ã‚½ãƒƒãƒ‰å®Œäº†å¾Œï¼ˆä¿®æ­£ãŒå®Ÿæ–½ã•ã‚Œã‚‹å ´åˆï¼‰

**æ¤œè¨¼æ¡ä»¶**:
- ã‚³ãƒŸãƒƒãƒˆãƒ­ã‚°ã«æ­£ã—ã„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¨˜éŒ²ã•ã‚Œã‚‹
- ãƒªãƒ¢ãƒ¼ãƒˆãƒ–ãƒ©ãƒ³ãƒã«ã‚³ãƒŸãƒƒãƒˆãŒãƒ—ãƒƒã‚·ãƒ¥ã•ã‚Œã‚‹
- metadata.jsonãŒã‚³ãƒŸãƒƒãƒˆã«å«ã¾ã‚Œã‚‹

---

### FR-2: ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚¹ã‚­ãƒ¼ãƒã®æ‹¡å¼µ

**å„ªå…ˆåº¦**: é«˜

**èª¬æ˜**: metadata.jsonã®PhaseMetadataã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã«ã€ã‚¹ãƒ†ãƒƒãƒ—ç®¡ç†ç”¨ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’è¿½åŠ ã™ã‚‹ã€‚

**è©³ç´°ä»•æ§˜**:

1. **æ–°è¦ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰**:
   ```typescript
   interface PhaseMetadata {
     status: 'pending' | 'in_progress' | 'completed' | 'failed';
     current_step?: 'execute' | 'review' | 'revise' | null;
     completed_steps: ('execute' | 'review' | 'revise')[];
     retry_count: number; // æ—¢å­˜
     output_files: Record<string, string>; // æ—¢å­˜
     // ... ãã®ä»–æ—¢å­˜ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
   }
   ```

2. **ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®æ„å‘³**:
   - `current_step`: ç¾åœ¨å®Ÿè¡Œä¸­ã®ã‚¹ãƒ†ãƒƒãƒ—ï¼ˆå®Ÿè¡Œä¸­ã§ãªã„å ´åˆã¯nullï¼‰
   - `completed_steps`: å®Œäº†æ¸ˆã¿ã‚¹ãƒ†ãƒƒãƒ—ã®é…åˆ—ï¼ˆå®Ÿè¡Œé †åºã‚’ä¿æŒï¼‰

3. **ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿æ›´æ–°ã‚¿ã‚¤ãƒŸãƒ³ã‚°**:
   - **ã‚¹ãƒ†ãƒƒãƒ—é–‹å§‹å‰**: `current_step`ã‚’æ›´æ–°ï¼ˆä¾‹: "execute"ï¼‰
   - **ã‚¹ãƒ†ãƒƒãƒ—å®Œäº†å¾Œ**: `completed_steps`ã«è¿½åŠ ã€`current_step`ã‚’nullã«è¨­å®š
   - **ãƒ•ã‚§ãƒ¼ã‚ºå®Œäº†å¾Œ**: `status`ã‚’"completed"ã«ã€`current_step`ã‚’nullã«è¨­å®š

4. **ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã®ä¿å­˜**:
   - å„ã‚¹ãƒ†ãƒƒãƒ—ã®Gitã‚³ãƒŸãƒƒãƒˆã«å«ã‚ã¦ãƒ—ãƒƒã‚·ãƒ¥
   - ãƒªãƒ¢ãƒ¼ãƒˆãƒ–ãƒ©ãƒ³ãƒã‹ã‚‰å¸¸ã«æœ€æ–°çŠ¶æ…‹ã‚’å–å¾—å¯èƒ½

**æ¤œè¨¼æ¡ä»¶**:
- TypeScriptã®å‹å®šç¾©ãŒæ­£ã—ãæ›´æ–°ã•ã‚Œã‚‹
- ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿æ›¸ããŒæ­£å¸¸ã«å‹•ä½œã™ã‚‹
- æ—¢å­˜ã®ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã¨ã®äº’æ›æ€§ãŒä¿ãŸã‚Œã‚‹

---

### FR-3: ã‚¹ãƒ†ãƒƒãƒ—å˜ä½ã®ãƒ¬ã‚¸ãƒ¥ãƒ¼ãƒ æ©Ÿèƒ½

**å„ªå…ˆåº¦**: é«˜

**èª¬æ˜**: ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å†é–‹æ™‚ã«ã€metadata.jsonã®current_stepã¨completed_stepsã‚’åŸºã«ã€é©åˆ‡ãªã‚¹ãƒ†ãƒƒãƒ—ã‹ã‚‰å‡¦ç†ã‚’å†é–‹ã™ã‚‹ã€‚

**è©³ç´°ä»•æ§˜**:

1. **ãƒ¬ã‚¸ãƒ¥ãƒ¼ãƒ åˆ¤å®šãƒ­ã‚¸ãƒƒã‚¯**:
   - ãƒªãƒ¢ãƒ¼ãƒˆãƒ–ãƒ©ãƒ³ãƒã‹ã‚‰æœ€æ–°çŠ¶æ…‹ã‚’pullï¼ˆCIç’°å¢ƒï¼‰
   - metadata.jsonã‚’èª­ã¿è¾¼ã¿
   - `completed_steps`ã«å«ã¾ã‚Œã‚‹ã‚¹ãƒ†ãƒƒãƒ—ã¯ã‚¹ã‚­ãƒƒãƒ—
   - `current_step`ãŒnullä»¥å¤–ã®å ´åˆã€ãã®ã‚¹ãƒ†ãƒƒãƒ—ã‹ã‚‰å†é–‹
   - `current_step`ãŒnullã®å ´åˆã€æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ï¼ˆcompleted_stepsã«å«ã¾ã‚Œãªã„æœ€åˆã®ã‚¹ãƒ†ãƒƒãƒ—ï¼‰ã‹ã‚‰é–‹å§‹

2. **ã‚¹ãƒ†ãƒƒãƒ—ã‚¹ã‚­ãƒƒãƒ—å‡¦ç†**:
   ```typescript
   if (metadata.completed_steps.includes('execute')) {
     console.log('Skipping execute step (already completed)');
   } else {
     await this.execute(context);
     // ã‚³ãƒŸãƒƒãƒˆï¼†ãƒ—ãƒƒã‚·ãƒ¥
   }
   ```

3. **CIç’°å¢ƒã§ã®å‹•ä½œ**:
   ```
   Jenkins Build #1:
   â”œâ”€â”€ execute() âœ… â†’ ã‚³ãƒŸãƒƒãƒˆï¼†ãƒ—ãƒƒã‚·ãƒ¥æˆåŠŸ
   â”œâ”€â”€ review() âŒ å¤±æ•—
   â””â”€â”€ ãƒ“ãƒ«ãƒ‰çµ‚äº†ï¼ˆãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹å‰Šé™¤ï¼‰

   Jenkins Build #2ï¼ˆãƒ¬ã‚¸ãƒ¥ãƒ¼ãƒ ï¼‰:
   â”œâ”€â”€ git pullï¼ˆæœ€æ–°çŠ¶æ…‹ã‚’å–å¾—ï¼‰
   â”œâ”€â”€ metadata.jsonèª­ã¿è¾¼ã¿ï¼ˆcurrent_step: "review", completed_steps: ["execute"]ï¼‰
   â”œâ”€â”€ execute() â­ï¸ ã‚¹ã‚­ãƒƒãƒ—
   â””â”€â”€ review() ğŸ”„ å†å®Ÿè¡Œ
   ```

4. **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**:
   - ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ä¸æ•´åˆæ™‚ï¼ˆcurrent_stepã¨completed_stepsã®çŸ›ç›¾ï¼‰ã¯è­¦å‘Šã‚’è¡¨ç¤ºã—ã€å®‰å…¨å´ï¼ˆæœ€åˆã‹ã‚‰å†å®Ÿè¡Œï¼‰ã«ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
   - ãƒªãƒ¢ãƒ¼ãƒˆãƒ–ãƒ©ãƒ³ãƒãŒå­˜åœ¨ã—ãªã„å ´åˆã¯é€šå¸¸ã®æ–°è¦å®Ÿè¡Œã¨ã—ã¦æ‰±ã†

**æ¤œè¨¼æ¡ä»¶**:
- executeå®Œäº†å¾Œã®ãƒ¬ã‚¸ãƒ¥ãƒ¼ãƒ ã§executeãŒã‚¹ã‚­ãƒƒãƒ—ã•ã‚Œã‚‹
- reviewå¤±æ•—å¾Œã®ãƒ¬ã‚¸ãƒ¥ãƒ¼ãƒ ã§reviewã‹ã‚‰å†é–‹ã•ã‚Œã‚‹
- CIç’°å¢ƒã§ãƒªãƒ¢ãƒ¼ãƒˆåŒæœŸãŒæ­£å¸¸ã«å‹•ä½œã™ã‚‹

---

### FR-4: ãƒ—ãƒƒã‚·ãƒ¥å¤±æ•—æ™‚ã®ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

**å„ªå…ˆåº¦**: é«˜

**èª¬æ˜**: Gitãƒ—ãƒƒã‚·ãƒ¥å¤±æ•—æ™‚ã«é©åˆ‡ã«ãƒªãƒˆãƒ©ã‚¤ã‚’å®Ÿè¡Œã—ã€å…¨ã¦å¤±æ•—ã—ãŸå ´åˆã¯ã‚¹ãƒ†ãƒƒãƒ—ã‚’æœªå®Œäº†ã¨ã—ã¦è¨˜éŒ²ã™ã‚‹ã€‚

**è©³ç´°ä»•æ§˜**:

1. **ãƒªãƒˆãƒ©ã‚¤å‹•ä½œ**:
   - ã‚³ãƒŸãƒƒãƒˆæˆåŠŸå¾Œã€`pushToRemote()`ã‚’å®Ÿè¡Œï¼ˆæ—¢å­˜æ©Ÿèƒ½ï¼‰
   - ãƒ—ãƒƒã‚·ãƒ¥å¤±æ•—æ™‚ã€æœ€å¤§3å›ãƒªãƒˆãƒ©ã‚¤ï¼ˆæŒ‡æ•°ãƒãƒƒã‚¯ã‚ªãƒ•: 1ç§’ã€2ç§’ã€4ç§’ï¼‰
   - å„ãƒªãƒˆãƒ©ã‚¤å‰ã«ãƒªãƒ¢ãƒ¼ãƒˆã‹ã‚‰æœ€æ–°çŠ¶æ…‹ã‚’pullã—ã¦ç«¶åˆã‚’è§£æ±º

2. **æˆåŠŸæ™‚ã®å‡¦ç†**:
   - ã‚¹ãƒ†ãƒƒãƒ—å®Œäº†ã¨ã—ã¦`completed_steps`ã«è¿½åŠ 
   - `current_step`ã‚’nullã«è¨­å®š
   - æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã¸é€²è¡Œ

3. **å¤±æ•—æ™‚ã®å‡¦ç†**:
   - ã‚¹ãƒ†ãƒƒãƒ—æœªå®Œäº†ã¨ã—ã¦`current_step`ã‚’ç¶­æŒ
   - ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ãƒ­ã‚°ã«è¨˜éŒ²
   - ãƒ•ã‚§ãƒ¼ã‚ºã®`status`ã‚’"failed"ã«è¨­å®š
   - æ¬¡å›ãƒ¬ã‚¸ãƒ¥ãƒ¼ãƒ æ™‚ã€åŒã˜ã‚¹ãƒ†ãƒƒãƒ—ã‚’æœ€åˆã‹ã‚‰å†å®Ÿè¡Œ

4. **CIç’°å¢ƒã§ã®é‡è¦æ€§**:
   - CIç’°å¢ƒã§ã¯ãƒ­ãƒ¼ã‚«ãƒ«ã‚³ãƒŸãƒƒãƒˆã¯ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ãƒªã‚»ãƒƒãƒˆã§æ¶ˆå¤±
   - ãƒ—ãƒƒã‚·ãƒ¥æˆåŠŸãŒé€²æ—ä¿å­˜ã®å”¯ä¸€ã®æ‰‹æ®µ
   - ãƒ—ãƒƒã‚·ãƒ¥å¤±æ•—æ™‚ã¯æ˜ç¢ºãªã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã§é–‹ç™ºè€…ã«é€šçŸ¥

**æ¤œè¨¼æ¡ä»¶**:
- ãƒ—ãƒƒã‚·ãƒ¥æˆåŠŸæ™‚ã«ã‚¹ãƒ†ãƒƒãƒ—ãŒå®Œäº†ã¨ã—ã¦è¨˜éŒ²ã•ã‚Œã‚‹
- ãƒ—ãƒƒã‚·ãƒ¥å¤±æ•—æ™‚ã«ã‚¹ãƒ†ãƒƒãƒ—ãŒæœªå®Œäº†ã¨ã—ã¦è¨˜éŒ²ã•ã‚Œã‚‹
- ãƒªãƒˆãƒ©ã‚¤ãŒæœ€å¤§3å›å®Ÿè¡Œã•ã‚Œã‚‹

---

### FR-5: BasePhase.run()ãƒ¡ã‚½ãƒƒãƒ‰ã®ä¿®æ­£

**å„ªå…ˆåº¦**: é«˜

**èª¬æ˜**: BasePhaseã®`run()`ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä¿®æ­£ã—ã€å„ã‚¹ãƒ†ãƒƒãƒ—å¾Œã«ã‚³ãƒŸãƒƒãƒˆï¼†ãƒ—ãƒƒã‚·ãƒ¥ã‚’å®Ÿè¡Œã™ã‚‹ã‚ˆã†ã«å¤‰æ›´ã™ã‚‹ã€‚

**è©³ç´°ä»•æ§˜**:

1. **æ—¢å­˜ã®run()ãƒ¡ã‚½ãƒƒãƒ‰**ï¼ˆç¾åœ¨ï¼‰:
   ```typescript
   async run(options) {
     await this.execute(context);
     if (this.hasReview) {
       await this.review(context);
       if (reviewFailed) {
         await this.revise(context);
       }
     }
     // ãƒ•ã‚§ãƒ¼ã‚ºå®Œäº†å¾Œã«1å›ã ã‘ã‚³ãƒŸãƒƒãƒˆï¼†ãƒ—ãƒƒã‚·ãƒ¥
     if (gitManager) {
       await gitManager.commitPhaseOutput(...);
     }
   }
   ```

2. **æ–°ã—ã„run()ãƒ¡ã‚½ãƒƒãƒ‰**ï¼ˆä¿®æ­£å¾Œï¼‰:
   ```typescript
   async run(options) {
     // Execute step
     if (!metadata.completed_steps.includes('execute')) {
       metadata.current_step = 'execute';
       await metadataManager.save(metadata);

       await this.execute(context);

       await this.commitAndPushStep('execute', ...);
       metadata.completed_steps.push('execute');
       metadata.current_step = null;
       await metadataManager.save(metadata);
     }

     // Review step
     if (this.hasReview && !metadata.completed_steps.includes('review')) {
       metadata.current_step = 'review';
       await metadataManager.save(metadata);

       const reviewResult = await this.review(context);

       await this.commitAndPushStep('review', ...);
       metadata.completed_steps.push('review');
       metadata.current_step = null;
       await metadataManager.save(metadata);

       // Revise step (if needed)
       if (reviewFailed && !metadata.completed_steps.includes('revise')) {
         metadata.current_step = 'revise';
         await metadataManager.save(metadata);

         await this.revise(context);

         await this.commitAndPushStep('revise', ...);
         metadata.completed_steps.push('revise');
         metadata.current_step = null;
         await metadataManager.save(metadata);
       }
     }

     // ãƒ•ã‚§ãƒ¼ã‚ºå®Œäº†
     metadata.status = 'completed';
     await metadataManager.save(metadata);
   }
   ```

3. **commitAndPushStep()ãƒ¡ã‚½ãƒƒãƒ‰**ï¼ˆæ–°è¦è¿½åŠ ï¼‰:
   ```typescript
   private async commitAndPushStep(
     step: 'execute' | 'review' | 'revise',
     context: ExecutionContext
   ): Promise<void> {
     const message = this.buildStepCommitMessage(step, context);
     await gitManager.commitStepOutput(message, context);

     try {
       await gitManager.pushToRemote(context.branchName, 3); // æœ€å¤§3å›ãƒªãƒˆãƒ©ã‚¤
     } catch (error) {
       // ãƒ—ãƒƒã‚·ãƒ¥å¤±æ•—æ™‚ã®å‡¦ç†
       throw new Error(`Failed to push step ${step}: ${error.message}`);
     }
   }
   ```

**æ¤œè¨¼æ¡ä»¶**:
- å„ã‚¹ãƒ†ãƒƒãƒ—å¾Œã«ã‚³ãƒŸãƒƒãƒˆï¼†ãƒ—ãƒƒã‚·ãƒ¥ãŒå®Ÿè¡Œã•ã‚Œã‚‹
- ã‚¹ãƒ†ãƒƒãƒ—ã‚¹ã‚­ãƒƒãƒ—ãƒ­ã‚¸ãƒƒã‚¯ãŒæ­£å¸¸ã«å‹•ä½œã™ã‚‹
- ã‚¨ãƒ©ãƒ¼æ™‚ã«é©åˆ‡ã«ä¾‹å¤–ãŒã‚¹ãƒ­ãƒ¼ã•ã‚Œã‚‹

---

### FR-6: GitManagerã®æ‹¡å¼µ

**å„ªå…ˆåº¦**: é«˜

**èª¬æ˜**: GitManagerã«ã€ã‚¹ãƒ†ãƒƒãƒ—å˜ä½ã®ã‚³ãƒŸãƒƒãƒˆã‚’å®Ÿè¡Œã™ã‚‹æ©Ÿèƒ½ã‚’è¿½åŠ ã™ã‚‹ã€‚

**è©³ç´°ä»•æ§˜**:

1. **æ–°è¦ãƒ¡ã‚½ãƒƒãƒ‰**: `commitStepOutput()`
   ```typescript
   async commitStepOutput(
     phaseName: string,
     phaseNumber: number,
     step: 'execute' | 'review' | 'revise',
     issueNumber: number,
     workingDir: string
   ): Promise<void> {
     const message = this.buildStepCommitMessage(
       phaseName, phaseNumber, step, issueNumber
     );

     await this.git.add('.ai-workflow/**/*');
     await this.git.commit(message);
   }
   ```

2. **ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ç”Ÿæˆ**: `buildStepCommitMessage()`
   ```typescript
   private buildStepCommitMessage(
     phaseName: string,
     phaseNumber: number,
     step: string,
     issueNumber: number
   ): string {
     return `[ai-workflow] Phase ${phaseNumber} (${phaseName}) - ${step} completed

Issue: #${issueNumber}
Phase: ${phaseNumber} (${phaseName})
Step: ${step}
Status: completed

Auto-generated by AI Workflow`;
   }
   ```

3. **æ—¢å­˜ãƒ¡ã‚½ãƒƒãƒ‰ã¨ã®é–¢ä¿‚**:
   - `commitPhaseOutput()`ã¯å¼•ãç¶šãå­˜åœ¨ï¼ˆå¾Œæ–¹äº’æ›æ€§ã®ãŸã‚ï¼‰
   - æ–°ã—ã„ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã§ã¯`commitStepOutput()`ã‚’ä½¿ç”¨
   - æ—¢å­˜ã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã¯å½±éŸ¿ã‚’å—ã‘ãªã„

**æ¤œè¨¼æ¡ä»¶**:
- ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒæ­£ã—ã„å½¢å¼ã§ç”Ÿæˆã•ã‚Œã‚‹
- ã‚¹ãƒ†ãƒƒãƒ—ã®æˆæœç‰©ãŒæ­£ã—ãã‚³ãƒŸãƒƒãƒˆã•ã‚Œã‚‹
- æ—¢å­˜ã®commitPhaseOutput()ãŒå¼•ãç¶šãå‹•ä½œã™ã‚‹

---

### FR-7: ResumeManagerã®æ‹¡å¼µ

**å„ªå…ˆåº¦**: ä¸­

**èª¬æ˜**: ResumeManagerã«ã€ã‚¹ãƒ†ãƒƒãƒ—å˜ä½ã§ã®ãƒ¬ã‚¸ãƒ¥ãƒ¼ãƒ åˆ¤å®šæ©Ÿèƒ½ã‚’è¿½åŠ ã™ã‚‹ã€‚

**è©³ç´°ä»•æ§˜**:

1. **æ–°è¦ãƒ¡ã‚½ãƒƒãƒ‰**: `getResumeStep()`
   ```typescript
   getResumeStep(phaseName: string, metadata: WorkflowState): {
     shouldResume: boolean;
     resumeStep: 'execute' | 'review' | 'revise' | null;
     completedSteps: string[];
   } {
     const phaseMetadata = metadata.phases[phaseName];

     if (!phaseMetadata || phaseMetadata.status === 'pending') {
       return { shouldResume: false, resumeStep: null, completedSteps: [] };
     }

     if (phaseMetadata.status === 'completed') {
       return { shouldResume: false, resumeStep: null, completedSteps: phaseMetadata.completed_steps };
     }

     // in_progress ã¾ãŸã¯ failed
     const resumeStep = phaseMetadata.current_step || this.getNextStep(phaseMetadata.completed_steps);
     return {
       shouldResume: true,
       resumeStep,
       completedSteps: phaseMetadata.completed_steps
     };
   }
   ```

2. **æ¬¡ã‚¹ãƒ†ãƒƒãƒ—åˆ¤å®š**: `getNextStep()`
   ```typescript
   private getNextStep(completedSteps: string[]): 'execute' | 'review' | 'revise' {
     if (!completedSteps.includes('execute')) return 'execute';
     if (!completedSteps.includes('review')) return 'review';
     if (!completedSteps.includes('revise')) return 'revise';
     return 'execute'; // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
   }
   ```

3. **CIç’°å¢ƒå¯¾å¿œ**:
   - `getResumeStep()`å‘¼ã³å‡ºã—å‰ã«ãƒªãƒ¢ãƒ¼ãƒˆãƒ–ãƒ©ãƒ³ãƒã‹ã‚‰pull
   - metadata.jsonã®åŒæœŸã‚’ä¿è¨¼

**æ¤œè¨¼æ¡ä»¶**:
- æ­£ã—ã„ã‚¹ãƒ†ãƒƒãƒ—ã‹ã‚‰å†é–‹ã•ã‚Œã‚‹
- completed_stepsãŒæ­£ã—ãè§£é‡ˆã•ã‚Œã‚‹
- ã‚¨ãƒƒã‚¸ã‚±ãƒ¼ã‚¹ï¼ˆãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ä¸æ•´åˆï¼‰ã§å®‰å…¨ã«ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ã™ã‚‹

---

### FR-8: ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å‡¦ç†

**å„ªå…ˆåº¦**: ä¸­

**èª¬æ˜**: æ—¢å­˜ã®metadata.jsonã«å¯¾ã—ã¦ã€æ–°ã—ã„ã‚¹ã‚­ãƒ¼ãƒã¸ã®ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å‡¦ç†ã‚’å®Ÿè£…ã™ã‚‹ã€‚

**è©³ç´°ä»•æ§˜**:

1. **ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å¯¾è±¡**:
   - æ—¢å­˜ã®metadata.jsonï¼ˆcurrent_stepã€completed_stepsãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãªã—ï¼‰

2. **ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ­ã‚¸ãƒƒã‚¯**:
   ```typescript
   function migrateMetadata(metadata: WorkflowState): WorkflowState {
     for (const [phaseName, phaseData] of Object.entries(metadata.phases)) {
       if (!phaseData.completed_steps) {
         // completed ãƒ•ã‚§ãƒ¼ã‚º
         if (phaseData.status === 'completed') {
           phaseData.completed_steps = ['execute', 'review', 'revise'];
           phaseData.current_step = null;
         }
         // in_progress ãƒ•ã‚§ãƒ¼ã‚º
         else if (phaseData.status === 'in_progress') {
           phaseData.completed_steps = [];
           phaseData.current_step = 'execute';
         }
         // pending ã¾ãŸã¯ failed
         else {
           phaseData.completed_steps = [];
           phaseData.current_step = null;
         }
       }
     }
     return metadata;
   }
   ```

3. **å®Ÿè¡Œã‚¿ã‚¤ãƒŸãƒ³ã‚°**:
   - MetadataManager.load()ãƒ¡ã‚½ãƒƒãƒ‰å†…ã§è‡ªå‹•çš„ã«å®Ÿè¡Œ
   - ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å¾Œã€metadata.jsonã‚’ä¿å­˜

4. **ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—**:
   - ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å‰ã«`metadata.json.backup`ã‚’ä½œæˆ
   - ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å¤±æ•—æ™‚ã«ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯å¯èƒ½

**æ¤œè¨¼æ¡ä»¶**:
- æ—¢å­˜ã®ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ãŒæ­£ã—ãæ–°ã‚¹ã‚­ãƒ¼ãƒã«å¤‰æ›ã•ã‚Œã‚‹
- ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å¾Œã‚‚æ—¢å­˜ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ãŒå‹•ä½œã™ã‚‹
- ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãŒæ­£ã—ãä½œæˆã•ã‚Œã‚‹

---

## 3. éæ©Ÿèƒ½è¦ä»¶

### NFR-1: ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹

**å„ªå…ˆåº¦**: ä¸­

**è¦ä»¶**:
- ã‚¹ãƒ†ãƒƒãƒ—å˜ä½ã®Gitã‚³ãƒŸãƒƒãƒˆï¼†ãƒ—ãƒƒã‚·ãƒ¥ã«ã‚ˆã‚‹ã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰ã¯ã€ãƒ•ã‚§ãƒ¼ã‚ºå…¨ä½“ã®å®Ÿè¡Œæ™‚é–“ã®5%ä»¥å†…ã«æŠ‘ãˆã‚‹
- ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿èª­ã¿æ›¸ãã®é…å»¶ã¯100msä»¥å†…
- ãƒ—ãƒƒã‚·ãƒ¥ã®ãƒªãƒˆãƒ©ã‚¤ã«ã‚ˆã‚‹é…å»¶ã¯ã€1å›ã‚ãŸã‚Šæœ€å¤§7ç§’ï¼ˆ1ç§’+2ç§’+4ç§’ï¼‰

**æ¸¬å®šæ–¹æ³•**:
- ãƒ•ã‚§ãƒ¼ã‚ºå®Ÿè¡Œå‰å¾Œã®æ™‚é–“ã‚’è¨ˆæ¸¬
- ã‚³ãƒŸãƒƒãƒˆï¼†ãƒ—ãƒƒã‚·ãƒ¥ã®æ™‚é–“ã‚’å€‹åˆ¥ã«è¨ˆæ¸¬
- ã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰ç‡ã‚’ç®—å‡ºï¼ˆã‚³ãƒŸãƒƒãƒˆæ™‚é–“ / ãƒ•ã‚§ãƒ¼ã‚ºå…¨ä½“æ™‚é–“ï¼‰

---

### NFR-2: ä¿¡é ¼æ€§

**å„ªå…ˆåº¦**: é«˜

**è¦ä»¶**:
- ãƒ—ãƒƒã‚·ãƒ¥å¤±æ•—æ™‚ã®ãƒªãƒˆãƒ©ã‚¤æˆåŠŸç‡: 95%ä»¥ä¸Šï¼ˆãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ä¸€æ™‚éšœå®³ã‚’æƒ³å®šï¼‰
- ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ä¸æ•´åˆã«ã‚ˆã‚‹ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼åœæ­¢: 0ä»¶ï¼ˆãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯æ©Ÿèƒ½ã«ã‚ˆã‚Šç¶™ç¶šï¼‰
- CIç’°å¢ƒã§ã®ãƒ¬ã‚¸ãƒ¥ãƒ¼ãƒ æˆåŠŸç‡: 99%ä»¥ä¸Š

**ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**:
- ã™ã¹ã¦ã®ä¾‹å¤–ã‚’é©åˆ‡ã«ã‚­ãƒ£ãƒƒãƒã—ã€ãƒ­ã‚°ã«è¨˜éŒ²
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«åˆ†ã‹ã‚Šã‚„ã™ã„ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º
- è‡´å‘½çš„ã§ãªã„ã‚¨ãƒ©ãƒ¼ã¯è­¦å‘Šã¨ã—ã¦æ‰±ã„ã€å‡¦ç†ã‚’ç¶™ç¶š

---

### NFR-3: ä¿å®ˆæ€§

**å„ªå…ˆåº¦**: ä¸­

**è¦ä»¶**:
- æ—¢å­˜ã®ã‚³ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹ã¨ã®æ•´åˆæ€§ã‚’ä¿ã¤
- TypeScriptã®å‹å®šç¾©ã‚’å³æ ¼ã«é©ç”¨ï¼ˆ`strict: true`ï¼‰
- ãƒ­ã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯æ§‹é€ åŒ–ã•ã‚Œã€æ¤œç´¢ãƒ»ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ãŒå®¹æ˜“
- ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆï¼ˆCLAUDE.mdã€ARCHITECTURE.mdï¼‰ã‚’æ›´æ–°

**ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„**:
- ESLintãƒ«ãƒ¼ãƒ«ã«æº–æ‹ 
- ãƒ¡ã‚½ãƒƒãƒ‰åã¯å‹•è©ã§å§‹ã‚ã‚‹ï¼ˆä¾‹: `commitStepOutput`ã€`getResumeStep`ï¼‰
- è¤‡é›‘ãªãƒ­ã‚¸ãƒƒã‚¯ã«ã¯ã‚³ãƒ¡ãƒ³ãƒˆã‚’è¿½åŠ 

---

### NFR-4: æ‹¡å¼µæ€§

**å„ªå…ˆåº¦**: ä½

**è¦ä»¶**:
- å°†æ¥çš„ã«ã‚¹ãƒ†ãƒƒãƒ—ç¨®åˆ¥ã‚’è¿½åŠ å¯èƒ½ï¼ˆä¾‹: "validate"ã€"deploy"ï¼‰
- ä»–ã®Gitãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚°ã‚µãƒ¼ãƒ“ã‚¹ï¼ˆGitLabã€Bitbucketï¼‰ã¸ã®æ‹¡å¼µã‚’è€ƒæ…®
- ã‚«ã‚¹ã‚¿ãƒ ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã®ã‚µãƒãƒ¼ãƒˆ

---

### NFR-5: ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£

**å„ªå…ˆåº¦**: ä¸­

**è¦ä»¶**:
- Gitã‚³ãƒŸãƒƒãƒˆã«æ©Ÿå¯†æƒ…å ±ï¼ˆAPIã‚­ãƒ¼ã€ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ï¼‰ã‚’å«ã‚ãªã„
- ãƒ—ãƒƒã‚·ãƒ¥å¤±æ•—æ™‚ã®ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«èªè¨¼æƒ…å ±ã‚’å«ã‚ãªã„
- ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã®æ›¸ãè¾¼ã¿æ¨©é™ã‚’é©åˆ‡ã«åˆ¶é™

---

## 4. åˆ¶ç´„äº‹é …

### æŠ€è¡“çš„åˆ¶ç´„

1. **æ—¢å­˜ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®ç¶­æŒ**:
   - BasePhaseã€MetadataManagerã€GitManagerã®æ—¢å­˜ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’å¯èƒ½ãªé™ã‚Šä¿æŒ
   - æ—¢å­˜ã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã«å½±éŸ¿ã‚’ä¸ãˆãªã„å¾Œæ–¹äº’æ›æ€§ã®ç¢ºä¿

2. **Gitæ“ä½œã®åˆ¶ç´„**:
   - `simple-git`ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®æ©Ÿèƒ½ç¯„å›²å†…ã§å®Ÿè£…
   - ãƒªãƒ¢ãƒ¼ãƒˆãƒªãƒã‚¸ãƒˆãƒªã®æ¨©é™ï¼ˆpushæ¨©é™ï¼‰ãŒå¿…è¦
   - ãƒ–ãƒ©ãƒ³ãƒä¿è­·ãƒ«ãƒ¼ãƒ«ï¼ˆforce pushã®ç¦æ­¢ï¼‰ã«æº–æ‹ 

3. **CI/CDç’°å¢ƒã®åˆ¶ç´„**:
   - Jenkinsãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ã¯å„ãƒ“ãƒ«ãƒ‰å¾Œã«ãƒªã‚»ãƒƒãƒˆã•ã‚Œã‚‹
   - ãƒªãƒ¢ãƒ¼ãƒˆãƒ–ãƒ©ãƒ³ãƒãŒå”¯ä¸€ã®æ°¸ç¶šåŒ–æ‰‹æ®µ
   - ç’°å¢ƒå¤‰æ•°ï¼ˆ`GITHUB_TOKEN`ã€`GIT_COMMIT_USER_NAME`ãªã©ï¼‰ã«ä¾å­˜

4. **TypeScript/Node.jsã®åˆ¶ç´„**:
   - Node.js 20ä»¥ä¸Š
   - TypeScript strict modeã«æº–æ‹ 
   - ES Modulesã®ä½¿ç”¨

---

### ãƒªã‚½ãƒ¼ã‚¹åˆ¶ç´„

1. **æ™‚é–“**: è¦‹ç©ã‚‚ã‚Šå·¥æ•°20~28æ™‚é–“ï¼ˆPlanning Documentã‚ˆã‚Šï¼‰
2. **é–‹ç™ºè€…**: 1åï¼ˆAIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ + ãƒ¬ãƒ“ãƒ¥ã‚¢ãƒ¼ï¼‰
3. **ãƒ†ã‚¹ãƒˆç’°å¢ƒ**: ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒ + Jenkins CIç’°å¢ƒ

---

### ãƒãƒªã‚·ãƒ¼åˆ¶ç´„

1. **ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„**: CLAUDE.mdã«è¨˜è¼‰ã®ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã«æº–æ‹ 
2. **ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸**: `[ai-workflow]`ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ã‚’ä½¿ç”¨
3. **ãƒ–ãƒ©ãƒ³ãƒæˆ¦ç•¥**: `ai-workflow/issue-{issue_number}`å½¢å¼ã®ãƒ–ãƒ©ãƒ³ãƒå
4. **ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ—ãƒ­ã‚»ã‚¹**: ã™ã¹ã¦ã®ãƒ•ã‚§ãƒ¼ã‚ºã§ã‚¯ãƒªãƒ†ã‚£ã‚«ãƒ«ã‚·ãƒ³ã‚­ãƒ³ã‚°ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’å®Ÿæ–½

---

## 5. å‰ææ¡ä»¶

### ã‚·ã‚¹ãƒ†ãƒ ç’°å¢ƒ

1. **Node.js**: 20ä»¥ä¸Š
2. **npm**: 10ä»¥ä¸Š
3. **Git**: 2.30ä»¥ä¸Š
4. **TypeScript**: 5.x

### ä¾å­˜ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

1. **simple-git**: Gitæ“ä½œãƒ©ã‚¤ãƒ–ãƒ©ãƒª
2. **@octokit/rest**: GitHub API ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ
3. **fs-extra**: ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ æ“ä½œ
4. **Jest**: ãƒ†ã‚¹ãƒˆãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯

### å¤–éƒ¨ã‚·ã‚¹ãƒ†ãƒ é€£æº

1. **GitHub**: ãƒªãƒ¢ãƒ¼ãƒˆãƒªãƒã‚¸ãƒˆãƒªã€Issueã€PR
2. **Jenkins**: CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
3. **Claude/Codex API**: AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ

### ç’°å¢ƒå¤‰æ•°

1. **å¿…é ˆ**:
   - `GITHUB_TOKEN`: GitHub ãƒ‘ãƒ¼ã‚½ãƒŠãƒ«ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³
   - `GITHUB_REPOSITORY`: `owner/repo`å½¢å¼

2. **ã‚ªãƒ—ã‚·ãƒ§ãƒ³**:
   - `GIT_COMMIT_USER_NAME`: Gitã‚³ãƒŸãƒƒãƒˆä½œæˆè€…å
   - `GIT_COMMIT_USER_EMAIL`: Gitã‚³ãƒŸãƒƒãƒˆä½œæˆè€…ãƒ¡ãƒ¼ãƒ«
   - `REPOS_ROOT`: ãƒãƒ«ãƒãƒªãƒã‚¸ãƒˆãƒªç’°å¢ƒã®ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª

---

## 6. å—ã‘å…¥ã‚ŒåŸºæº–

### AC-1: Execute ã‚¹ãƒ†ãƒƒãƒ—å¾Œã®Gitã‚³ãƒŸãƒƒãƒˆï¼†ãƒ—ãƒƒã‚·ãƒ¥

**Given**: Requirements Phaseã®Executeã‚¹ãƒ†ãƒƒãƒ—ãŒå®Œäº†ã—ãŸ
**When**: ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’å®Ÿè¡Œã™ã‚‹
**Then**: ä»¥ä¸‹ãŒç¢ºèªã§ãã‚‹
- ãƒ­ãƒ¼ã‚«ãƒ«ãƒ–ãƒ©ãƒ³ãƒã«`[ai-workflow] Phase 1 (requirements) - execute completed`ã¨ã„ã†ã‚³ãƒŸãƒƒãƒˆãŒå­˜åœ¨
- ãƒªãƒ¢ãƒ¼ãƒˆãƒ–ãƒ©ãƒ³ãƒï¼ˆ`origin/ai-workflow/issue-123`ï¼‰ã«ã‚‚åŒã˜ã‚³ãƒŸãƒƒãƒˆãŒå­˜åœ¨
- ã‚³ãƒŸãƒƒãƒˆã«`.ai-workflow/issue-123/metadata.json`ãŒå«ã¾ã‚Œã‚‹

**æ¤œè¨¼ã‚³ãƒãƒ³ãƒ‰**:
```bash
git log -1 --oneline
# Expected: [ai-workflow] Phase 1 (requirements) - execute completed

git log origin/ai-workflow/issue-123 -1 --oneline
# Expected: [ai-workflow] Phase 1 (requirements) - execute completed
```

---

### AC-2: Review ã‚¹ãƒ†ãƒƒãƒ—å¾Œã®Gitã‚³ãƒŸãƒƒãƒˆï¼†ãƒ—ãƒƒã‚·ãƒ¥

**Given**: Requirements Phaseã®Reviewã‚¹ãƒ†ãƒƒãƒ—ãŒå®Œäº†ã—ãŸ
**When**: ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’å®Ÿè¡Œã™ã‚‹
**Then**: ä»¥ä¸‹ãŒç¢ºèªã§ãã‚‹
- ãƒ­ãƒ¼ã‚«ãƒ«ãƒ–ãƒ©ãƒ³ãƒã«`[ai-workflow] Phase 1 (requirements) - review completed`ã¨ã„ã†ã‚³ãƒŸãƒƒãƒˆãŒå­˜åœ¨
- ãƒªãƒ¢ãƒ¼ãƒˆãƒ–ãƒ©ãƒ³ãƒã«ã‚‚åŒã˜ã‚³ãƒŸãƒƒãƒˆãŒå­˜åœ¨

**æ¤œè¨¼ã‚³ãƒãƒ³ãƒ‰**:
```bash
git log -1 --oneline
# Expected: [ai-workflow] Phase 1 (requirements) - review completed
```

---

### AC-3: Revise ã‚¹ãƒ†ãƒƒãƒ—å¾Œã®Gitã‚³ãƒŸãƒƒãƒˆï¼†ãƒ—ãƒƒã‚·ãƒ¥

**Given**: Requirements Phaseã®Reviseã‚¹ãƒ†ãƒƒãƒ—ãŒå®Œäº†ã—ãŸï¼ˆãƒ¬ãƒ“ãƒ¥ãƒ¼å¤±æ•—æ™‚ã®ã¿ï¼‰
**When**: ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’å®Ÿè¡Œã™ã‚‹
**Then**: ä»¥ä¸‹ãŒç¢ºèªã§ãã‚‹
- ãƒ­ãƒ¼ã‚«ãƒ«ãƒ–ãƒ©ãƒ³ãƒã«`[ai-workflow] Phase 1 (requirements) - revise completed`ã¨ã„ã†ã‚³ãƒŸãƒƒãƒˆãŒå­˜åœ¨
- ãƒªãƒ¢ãƒ¼ãƒˆãƒ–ãƒ©ãƒ³ãƒã«ã‚‚åŒã˜ã‚³ãƒŸãƒƒãƒˆãŒå­˜åœ¨

**æ¤œè¨¼ã‚³ãƒãƒ³ãƒ‰**:
```bash
git log -1 --oneline
# Expected: [ai-workflow] Phase 1 (requirements) - revise completed
```

---

### AC-4: ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã«current_stepãŒè¨˜éŒ²ã•ã‚Œã€ãƒªãƒ¢ãƒ¼ãƒˆã«ãƒ—ãƒƒã‚·ãƒ¥ã•ã‚Œã‚‹

**Given**: Execute ã‚¹ãƒ†ãƒƒãƒ—ãŒå®Œäº†ã—ã€Reviewã‚¹ãƒ†ãƒƒãƒ—ãŒé–‹å§‹ã•ã‚ŒãŸ
**When**: ãƒªãƒ¢ãƒ¼ãƒˆãƒ–ãƒ©ãƒ³ãƒã‹ã‚‰ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹
**Then**: ä»¥ä¸‹ã®ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ãŒç¢ºèªã§ãã‚‹

```json
{
  "phases": {
    "requirements": {
      "status": "in_progress",
      "current_step": "review",
      "completed_steps": ["execute"],
      "output_files": {
        "execute": ".ai-workflow/issue-123/01_requirements/output/requirements.md"
      }
    }
  }
}
```

**æ¤œè¨¼ã‚³ãƒãƒ³ãƒ‰**:
```bash
git pull origin ai-workflow/issue-123
cat .ai-workflow/issue-123/metadata.json | jq '.phases.requirements'
```

---

### AC-5: Executeå®Œäº†å¾Œã®ãƒ¬ã‚¸ãƒ¥ãƒ¼ãƒ ï¼ˆCIç’°å¢ƒï¼‰

**Given**: Jenkins Build #1ã§Executeã‚¹ãƒ†ãƒƒãƒ—ãŒå®Œäº†ã—ã€Reviewã‚¹ãƒ†ãƒƒãƒ—ã§å¤±æ•—ã—ãŸ
**When**: Jenkins Build #2ã§ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’å†å®Ÿè¡Œã™ã‚‹
**Then**: ä»¥ä¸‹ãŒç¢ºèªã§ãã‚‹
- Executeã‚¹ãƒ†ãƒƒãƒ—ãŒã‚¹ã‚­ãƒƒãƒ—ã•ã‚Œã‚‹ï¼ˆ"Skipping execute step (already completed)"ã¨ã„ã†ãƒ­ã‚°ãŒè¡¨ç¤ºã•ã‚Œã‚‹ï¼‰
- Reviewã‚¹ãƒ†ãƒƒãƒ—ã‹ã‚‰å†é–‹ã•ã‚Œã‚‹
- ãƒˆãƒ¼ã‚¯ãƒ³æ¶ˆè²»é‡ãŒExecuteã‚¹ãƒ†ãƒƒãƒ—åˆ†å‰Šæ¸›ã•ã‚Œã‚‹

**æ¤œè¨¼æ–¹æ³•**:
```bash
# Jenkins Build #2ã®ãƒ­ã‚°ã‚’ç¢ºèª
# Expected log:
# INFO: Resuming phase 'requirements' from step 'review'
# INFO: Skipping execute step (already completed)
# INFO: Running review step...
```

---

### AC-6: ãƒ—ãƒƒã‚·ãƒ¥å¤±æ•—å¾Œã®å‹•ä½œ

**Given**: Executeã‚¹ãƒ†ãƒƒãƒ—ã§ã‚³ãƒŸãƒƒãƒˆã¯æˆåŠŸã—ãŸãŒã€ãƒ—ãƒƒã‚·ãƒ¥ãŒ3å›ã®ãƒªãƒˆãƒ©ã‚¤ã§ã‚‚å¤±æ•—ã—ãŸ
**When**: ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’å†å®Ÿè¡Œã™ã‚‹
**Then**: ä»¥ä¸‹ãŒç¢ºèªã§ãã‚‹
- ã‚¹ãƒ†ãƒƒãƒ—ãŒæœªå®Œäº†ã¨ã—ã¦è¨˜éŒ²ã•ã‚Œã‚‹ï¼ˆ`current_step: "execute"`ã€`completed_steps: []`ï¼‰
- ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã€ŒFailed to push step execute: ...ã€ãŒè¡¨ç¤ºã•ã‚Œã‚‹
- æ¬¡å›ãƒ¬ã‚¸ãƒ¥ãƒ¼ãƒ æ™‚ã€Executeã‚¹ãƒ†ãƒƒãƒ—ãŒæœ€åˆã‹ã‚‰å†å®Ÿè¡Œã•ã‚Œã‚‹

**æ¤œè¨¼æ–¹æ³•**:
```bash
cat .ai-workflow/issue-123/metadata.json | jq '.phases.requirements'
# Expected:
{
  "status": "failed",
  "current_step": "execute",
  "completed_steps": []
}
```

---

### AC-7: ãƒ•ã‚§ãƒ¼ã‚ºå®Œäº†å¾Œã®Gitãƒ­ã‚°

**Given**: Requirements PhaseãŒã™ã¹ã¦ã®ã‚¹ãƒ†ãƒƒãƒ—ï¼ˆExecuteã€Reviewã€Reviseï¼‰ã‚’å®Œäº†ã—ãŸ
**When**: Gitãƒ­ã‚°ã‚’ç¢ºèªã™ã‚‹
**Then**: ä»¥ä¸‹ã®3ã¤ã®ã‚³ãƒŸãƒƒãƒˆãŒå­˜åœ¨ã™ã‚‹

```bash
git log --oneline -3
# Expected:
# abc1234 [ai-workflow] Phase 1 (requirements) - revise completed
# def5678 [ai-workflow] Phase 1 (requirements) - review completed
# ghi9012 [ai-workflow] Phase 1 (requirements) - execute completed
```

---

### AC-8: ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³

**Given**: å¤ã„ã‚¹ã‚­ãƒ¼ãƒã®metadata.jsonï¼ˆcurrent_stepã€completed_stepsãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãªã—ï¼‰ãŒå­˜åœ¨ã™ã‚‹
**When**: ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’å®Ÿè¡Œã™ã‚‹
**Then**: ä»¥ä¸‹ãŒç¢ºèªã§ãã‚‹
- metadata.jsonãŒæ–°ã—ã„ã‚¹ã‚­ãƒ¼ãƒã«è‡ªå‹•çš„ã«ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã•ã‚Œã‚‹
- `metadata.json.backup`ãŒä½œæˆã•ã‚Œã‚‹
- æ—¢å­˜ã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ãŒå¼•ãç¶šãå‹•ä½œã™ã‚‹

**æ¤œè¨¼æ–¹æ³•**:
```bash
# ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å‰
cat metadata.json
# { "phases": { "planning": { "status": "completed", "retry_count": 0 } } }

# ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å®Ÿè¡Œ

# ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å¾Œ
cat metadata.json
# { "phases": { "planning": { "status": "completed", "retry_count": 0, "completed_steps": ["execute", "review", "revise"], "current_step": null } } }

# ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ç¢ºèª
ls -l metadata.json.backup
```

---

### AC-9: CIç’°å¢ƒã§ã®ãƒªãƒ¢ãƒ¼ãƒˆåŒæœŸ

**Given**: Jenkinsç’°å¢ƒã§ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ãŒå®Ÿè¡Œã•ã‚Œã‚‹
**When**: å„ãƒ“ãƒ«ãƒ‰ã§ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ãŒãƒªã‚»ãƒƒãƒˆã•ã‚Œã‚‹
**Then**: ä»¥ä¸‹ãŒç¢ºèªã§ãã‚‹
- ãƒ“ãƒ«ãƒ‰é–‹å§‹æ™‚ã«ãƒªãƒ¢ãƒ¼ãƒˆãƒ–ãƒ©ãƒ³ãƒã‹ã‚‰æœ€æ–°çŠ¶æ…‹ãŒpullã•ã‚Œã‚‹
- metadata.jsonãŒæ­£ã—ãåŒæœŸã•ã‚Œã‚‹
- å‰å›ã®ãƒ“ãƒ«ãƒ‰ã§å®Œäº†ã—ãŸã‚¹ãƒ†ãƒƒãƒ—ãŒã‚¹ã‚­ãƒƒãƒ—ã•ã‚Œã‚‹

**æ¤œè¨¼æ–¹æ³•**:
```bash
# Jenkinsãƒ­ã‚°ã‚’ç¢ºèª
# Expected log:
# INFO: Pulling latest changes from remote branch...
# INFO: Loaded metadata from .ai-workflow/issue-123/metadata.json
# INFO: Resuming from step 'review' (completed steps: ["execute"])
```

---

### AC-10: TypeScriptå‹å®‰å…¨æ€§

**Given**: PhaseMetadataã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ãŒæ‹¡å¼µã•ã‚ŒãŸ
**When**: TypeScriptã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚’å®Ÿè¡Œã™ã‚‹
**Then**: ä»¥ä¸‹ãŒç¢ºèªã§ãã‚‹
- ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼ãŒ0ä»¶
- `current_step`ã€`completed_steps`ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«å‹æ¨è«–ãŒåŠ¹ã
- ä¸æ­£ãªå€¤ï¼ˆä¾‹: `current_step: "invalid"`ï¼‰ã¯ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼ã¨ãªã‚‹

**æ¤œè¨¼æ–¹æ³•**:
```bash
npm run build
# Expected: âœ“ Built successfully
```

---

## 7. ã‚¹ã‚³ãƒ¼ãƒ—å¤–

ä»¥ä¸‹ã®é …ç›®ã¯ã€æœ¬Issueï¼ˆ#10ï¼‰ã®ã‚¹ã‚³ãƒ¼ãƒ—å¤–ã¨ã—ã€å°†æ¥çš„ãªæ‹¡å¼µå€™è£œã¨ã—ã¾ã™ï¼š

### 1. ã‚¹ãƒ†ãƒƒãƒ—ç¨®åˆ¥ã®è¿½åŠ 

**å†…å®¹**: execute / review / revise ä»¥å¤–ã®ã‚¹ãƒ†ãƒƒãƒ—ï¼ˆä¾‹: "validate"ã€"deploy"ã€"rollback"ï¼‰ã®è¿½åŠ 

**ç†ç”±**: æ—¢å­˜ã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã¨ã®æ•´åˆæ€§ã‚’ä¿ã¤ãŸã‚ã€ç¾æ™‚ç‚¹ã§ã¯æ—¢å­˜ã®3ã‚¹ãƒ†ãƒƒãƒ—ã«é™å®š

**å°†æ¥çš„ãªæ‹¡å¼µ**: Phase 0.4.0ä»¥é™ã§æ¤œè¨

---

### 2. ã‚«ã‚¹ã‚¿ãƒ ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ

**å†…å®¹**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã§ãã‚‹æ©Ÿèƒ½

**ç†ç”±**: æ¨™æº–ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã§ååˆ†ãªãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã‚’ã‚«ãƒãƒ¼ã§ãã‚‹ãŸã‚ã€ç¾æ™‚ç‚¹ã§ã¯ä¸è¦

**å°†æ¥çš„ãªæ‹¡å¼µ**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‹ã‚‰ã®è¦æœ›ã«å¿œã˜ã¦æ¤œè¨

---

### 3. Gitä»¥å¤–ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã®ã‚µãƒãƒ¼ãƒˆ

**å†…å®¹**: Mercurialã€SVNãªã©ã®ã‚µãƒãƒ¼ãƒˆ

**ç†ç”±**: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯GitHubã‚’å‰æã¨ã—ã¦ãŠã‚Šã€ä»–ã®VCSã®ã‚µãƒãƒ¼ãƒˆã¯å„ªå…ˆåº¦ãŒä½ã„

**å°†æ¥çš„ãªæ‹¡å¼µ**: è¦æœ›ãŒã‚ã‚Œã°åˆ¥Issueã§å¯¾å¿œ

---

### 4. ã‚¹ãƒ†ãƒƒãƒ—ã®ä¸¦åˆ—å®Ÿè¡Œ

**å†…å®¹**: è¤‡æ•°ã®ã‚¹ãƒ†ãƒƒãƒ—ã‚’ä¸¦åˆ—ã§å®Ÿè¡Œã™ã‚‹æ©Ÿèƒ½

**ç†ç”±**: execute â†’ review â†’ revise ã®ãƒ•ãƒ­ãƒ¼ã¯æœ¬è³ªçš„ã«ã‚·ãƒ¼ã‚±ãƒ³ã‚·ãƒ£ãƒ«ã§ã‚ã‚Šã€ä¸¦åˆ—åŒ–ã®æ©æµãŒå°‘ãªã„

**å°†æ¥çš„ãªæ‹¡å¼µ**: ç•°ãªã‚‹ãƒ•ã‚§ãƒ¼ã‚ºã®ä¸¦åˆ—å®Ÿè¡Œã¯åˆ¥Issueã§æ¤œè¨å¯èƒ½

---

### 5. ã‚¹ãƒ†ãƒƒãƒ—ãƒ¬ãƒ™ãƒ«ã®ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯

**å†…å®¹**: ç‰¹å®šã®ã‚¹ãƒ†ãƒƒãƒ—ã‚’å–ã‚Šæ¶ˆã—ã¦å‰ã®çŠ¶æ…‹ã«æˆ»ã™æ©Ÿèƒ½

**ç†ç”±**: è¤‡é›‘åº¦ãŒé«˜ãã€Gitã®å±¥æ­´ç®¡ç†ã¨ã®æ•´åˆæ€§ãŒé›£ã—ã„

**å°†æ¥çš„ãªæ‹¡å¼µ**: å®‰å…¨ãªãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯æ©Ÿèƒ½ã®è¨­è¨ˆãŒå¿…è¦

---

### 6. ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹é€šçŸ¥

**å†…å®¹**: Slackã€Microsoft Teamsç­‰ã¸ã®å„ã‚¹ãƒ†ãƒƒãƒ—å®Œäº†é€šçŸ¥

**ç†ç”±**: GitHub Issueã¸ã®ã‚³ãƒ¡ãƒ³ãƒˆæŠ•ç¨¿æ©Ÿèƒ½ã§åŸºæœ¬çš„ãªãƒ‹ãƒ¼ã‚ºã¯æº€ãŸã•ã‚Œã¦ã„ã‚‹

**å°†æ¥çš„ãªæ‹¡å¼µ**: Phase 0.5.0ä»¥é™ã§é€šçŸ¥æ©Ÿèƒ½å…¨èˆ¬ã‚’å¼·åŒ–ã™ã‚‹éš›ã«æ¤œè¨

---

### 7. ã‚¹ãƒ†ãƒƒãƒ—ã®ä¾å­˜é–¢ä¿‚ç®¡ç†

**å†…å®¹**: ç‰¹å®šã®ã‚¹ãƒ†ãƒƒãƒ—ãŒä»–ã®ãƒ•ã‚§ãƒ¼ã‚ºã®ã‚¹ãƒ†ãƒƒãƒ—ã«ä¾å­˜ã™ã‚‹é–¢ä¿‚ã‚’å®šç¾©ã™ã‚‹æ©Ÿèƒ½

**ç†ç”±**: ç¾åœ¨ã®ãƒ•ã‚§ãƒ¼ã‚ºä¾å­˜é–¢ä¿‚ã§ååˆ†ã§ã‚ã‚Šã€ã‚¹ãƒ†ãƒƒãƒ—ãƒ¬ãƒ™ãƒ«ã®ä¾å­˜é–¢ä¿‚ã¯éåº¦ã«è¤‡é›‘

**å°†æ¥çš„ãªæ‹¡å¼µ**: è¤‡é›‘ãªãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ãŒå¿…è¦ã«ãªã£ãŸå ´åˆã«æ¤œè¨

---

## ä»˜éŒ²A: ç”¨èªé›†

| ç”¨èª | å®šç¾© |
|------|------|
| **Phase** | ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã®å¤§ããªå˜ä½ï¼ˆä¾‹: Planningã€Requirementsã€Designï¼‰ã€‚0ã€œ9ã®ç•ªå·ãŒä»˜ä¸ã•ã‚Œã‚‹ã€‚ |
| **Step** | ãƒ•ã‚§ãƒ¼ã‚ºå†…ã®å‡¦ç†å˜ä½ã€‚executeã€reviewã€reviseã®3ç¨®é¡ã€‚ |
| **Execute** | ãƒ•ã‚§ãƒ¼ã‚ºã®ä¸»è¦ãªæˆæœç‰©ã‚’ç”Ÿæˆã™ã‚‹ã‚¹ãƒ†ãƒƒãƒ—ã€‚ |
| **Review** | Executeã§ç”Ÿæˆã—ãŸæˆæœç‰©ã‚’ãƒ¬ãƒ“ãƒ¥ãƒ¼ã™ã‚‹ã‚¹ãƒ†ãƒƒãƒ—ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰ã€‚ |
| **Revise** | Reviewã§å¤±æ•—ã—ãŸå ´åˆã«è‡ªå‹•ä¿®æ­£ã‚’è¡Œã†ã‚¹ãƒ†ãƒƒãƒ—ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ã€æœ€å¤§3å›ï¼‰ã€‚ |
| **Metadata** | ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã®çŠ¶æ…‹ã‚’è¨˜éŒ²ã™ã‚‹JSONå½¢å¼ã®ãƒ‡ãƒ¼ã‚¿ï¼ˆ`.ai-workflow/issue-*/metadata.json`ï¼‰ã€‚ |
| **current_step** | ç¾åœ¨å®Ÿè¡Œä¸­ã¾ãŸã¯æ¬¡ã«å®Ÿè¡Œã™ã¹ãã‚¹ãƒ†ãƒƒãƒ—ã€‚ |
| **completed_steps** | å®Œäº†æ¸ˆã¿ã‚¹ãƒ†ãƒƒãƒ—ã®é…åˆ—ã€‚ |
| **Resume** | ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’ä¸­æ–­ã—ãŸç®‡æ‰€ã‹ã‚‰å†é–‹ã™ã‚‹æ©Ÿèƒ½ã€‚ |
| **CIç’°å¢ƒ** | Jenkinsç­‰ã®ç¶™ç¶šçš„ã‚¤ãƒ³ãƒ†ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç’°å¢ƒã€‚å„ãƒ“ãƒ«ãƒ‰ã§ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ãŒãƒªã‚»ãƒƒãƒˆã•ã‚Œã‚‹ã€‚ |

---

## ä»˜éŒ²B: å‚ç…§ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- **Planning Document**: `.ai-workflow/issue-10/00_planning/output/planning.md`
- **CLAUDE.md**: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®å…¨ä½“æ–¹é‡ã¨ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³
- **ARCHITECTURE.md**: ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆæ€æƒ³
- **README.md**: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦ã¨ä½¿ç”¨æ–¹æ³•
- **Issue #10**: https://github.com/tielec/ai-workflow-agent/issues/10

---

## ä»˜éŒ²C: ãƒªã‚¹ã‚¯ã¨è»½æ¸›ç­–ï¼ˆPlanning Documentã‚ˆã‚Šï¼‰

| ãƒªã‚¹ã‚¯ | å½±éŸ¿åº¦ | ç¢ºç‡ | è»½æ¸›ç­– |
|--------|--------|------|--------|
| ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å¤±æ•— | é«˜ | ä¸­ | ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ä½œæˆã€ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆã€æ—¢å­˜ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã§ã®å‹•ä½œç¢ºèª |
| Gitãƒ—ãƒƒã‚·ãƒ¥å¤±æ•—æ™‚ã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ä¸­æ–­ | é«˜ | ä¸­ | ãƒªãƒˆãƒ©ã‚¤æ©Ÿèƒ½ï¼ˆæœ€å¤§3å›ï¼‰ã€ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®æ˜ç¢ºåŒ– |
| CIç’°å¢ƒã§ã®ãƒ¬ã‚¸ãƒ¥ãƒ¼ãƒ å¤±æ•— | é«˜ | ä¸­ | ãƒªãƒ¢ãƒ¼ãƒˆåŒæœŸå‡¦ç†ã€CIç’°å¢ƒã§ã®çµ±åˆãƒ†ã‚¹ãƒˆã€Jenkinsãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã§ã®ãƒ†ã‚¹ãƒˆ |
| æ—¢å­˜ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã¸ã®å½±éŸ¿ | ä¸­ | ä½ | å¾Œæ–¹äº’æ›æ€§ã®ãŸã‚ã®ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã€æ—¢å­˜ãƒ†ã‚¹ãƒˆã®å®Ÿè¡Œã€æ®µéšçš„ãƒ­ãƒ¼ãƒ«ã‚¢ã‚¦ãƒˆ |
| ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹åŠ£åŒ– | ä½ | ä½ | ã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰æ¸¬å®šã€å¿…è¦ã«å¿œã˜ã¦ãƒãƒƒãƒå‡¦ç†ã‚’æ¤œè¨ |

---

**ä½œæˆæ—¥**: 2025-01-XX
**Issue**: #10
**Phase**: Requirements (Phase 1)
**Status**: Draft
