# ドキュメント更新フェーズ - 実行プロンプト

## タスク概要
今回の変更により影響を受けるプロジェクトドキュメントを特定し、更新してください。

## 入力情報

### Planning Phase成果物
- Planning Document: {planning_document_path}

**注意**: Planning Phaseが実行されている場合、開発計画（実装戦略、テスト戦略、リスク、スケジュール）を必ず確認してください。

### 実装ログ（利用可能な場合）
{implementation_context}
<!--
  存在する場合: @implementation.md への参照
  存在しない場合: "実装ログは利用できません。リポジトリの実装内容を直接確認してください。"
-->

### テスト結果（利用可能な場合）
{testing_context}
<!--
  存在する場合: @test-result.md への参照
  存在しない場合: "テスト結果は利用できません。実装内容に基づいてドキュメントを更新してください。"
-->

### 要件定義書（参考・利用可能な場合）
{requirements_context}

### 設計書（参考・利用可能な場合）
{design_context}

### テストシナリオ（参考・利用可能な場合）
{test_scenario_context}

### テスト実装ログ（参考・利用可能な場合）
{test_implementation_context}

## ⚠️ 重要: プロンプト長制限への対応

### 自動的にコンテキストに含まれているファイル（Read 不要）
以下のファイルは Claude Code により自動読み込み済みです。Read ツールで再読込すると二重読み込みとなりコンテキストを浪費します。
- `CLAUDE.md`（リポジトリルート）
- `~/.claude/CLAUDE.md`（ユーザーグローバル）

### Read tool 使用時のルール
1. 一度に読み込むファイルは **最大3-5件まで** に絞る
2. 大きなファイルは `limit: 1000-2000` を必ず指定する（例: README.md, ARCHITECTURE.md）
3. 既に読んだファイルは再読み込みしない
4. 更新が必要なセクションを特定し、必要部分のみを部分読み込みする

### 段階的処理の推奨
1. 影響を受けるドキュメントをまずリストアップする（Read不要）
2. 重要度の高いものから **1-2ファイルずつ** 処理する
3. 各ドキュメントの更新内容を決めてから Edit で反映する

## ドキュメント更新手順

### ステップ1: プロジェクトのドキュメント構造を探索

まず、プロジェクトにどのようなドキュメントが存在するか調査してください：

**調査すべき場所**:
- プロジェクトルート直下の.mdファイル
- サブディレクトリ内の.mdファイル（.ai-workflowディレクトリは除く）
- docsディレクトリ（存在する場合）

**各ドキュメントを読んで把握すべきこと**:
- 誰が読むか（エンドユーザー、開発者、運用担当者等）
- 何が書かれているか（使い方、設計思想、トラブルシューティング等）
- どのような構成か（セクション構成、フォーマットスタイル）

### ステップ2: 変更内容の影響を分析

Phase 2（設計）とPhase 4（実装）から、以下を抽出してください：

**機能面の変更**:
- 新しく追加された機能は何か？
- 既存の動作が変わった部分は何か？
- 削除・非推奨になった機能は何か？

**インターフェースの変更**:
- 新しいCLIコマンド・オプションは？
- APIや設定ファイルの変更は？
- ユーザーの使い方が変わる点は？

**内部構造の変更**:
- アーキテクチャの変更は？
- 新しいコンポーネント・クラス・関数は？
- 設計思想や実装パターンの変更は？

### ステップ3: 影響を受けるドキュメントを特定

各ドキュメントに対して、以下の質問に答えてください：

1. **このドキュメントの読者は、今回の変更を知る必要があるか？**
2. **知らないと、読者が困るか？誤解するか？**
3. **ドキュメントの内容が古くなっていないか？**

→ **1つでもYesなら、更新対象**

### ステップ4: 更新の実施

更新が必要なドキュメントについて：

**原則**:
- 既存のスタイル・フォーマットを維持する
- 適切なセクションに追加する（新規セクションが必要なら作成）
- 簡潔に、必要な情報のみ記載する
- 既存の内容と矛盾しないようにする
- ドキュメント全体の整合性を保つ

**注意**:
- 過度な説明は避ける
- コードをそのままコピーしない
- ユーザー視点で必要な情報に絞る

### ステップ5: 更新結果の記録

documentation-update-log.mdを `.ai-workflow/issue-{issue_number}/07_documentation/output/documentation-update-log.md` として作成し、以下の内容を記載してください：

```markdown
# ドキュメント更新レポート

## 更新サマリー

以下のテーブル形式で更新したドキュメントのみをリストアップしてください：

| ファイル | 更新理由 |
|---------|---------|
| `{ファイル名}` | 1文で更新理由を記載 |

※ 更新不要と判断したファイルのリストは省略してください。
※ 詳細な変更内容は各ドキュメント自体に記載されているため、ここでは記載不要です。
```

## 品質ゲート（Phase 7: Documentation）

ドキュメント更新は以下の品質ゲートを満たす必要があります：

- [ ] **影響を受けるドキュメントが特定されている**
- [ ] **必要なドキュメントが更新されている**
- [ ] **更新内容が記録されている**

これらの品質ゲートは**必須要件**です。作成後、クリティカルシンキングレビューが実施されます。

## 出力形式

1. プロジェクトドキュメントを直接更新（README.md、ARCHITECTURE.md等）
2. 更新ログを `.ai-workflow/issue-{issue_number}/07_documentation/output/documentation-update-log.md` として保存

## 注意事項

1. **探索の徹底**: すべての.mdファイルを調査すること（.ai-workflowディレクトリは除く）

2. **判断基準の明確化**: 各ドキュメントについて、なぜ更新したか/しなかったかを記録

3. **既存スタイルの維持**: ドキュメントのフォーマットや書き方を変えないこと

4. **レビューされることを意識**: ドキュメントはクリティカルシンキングレビューが実施されます
   - 品質ゲート（3つの必須要件）を満たすこと
   - 更新が必要なドキュメントをすべて特定していること

## ドキュメント更新開始

上記を踏まえ、プロジェクトドキュメントの更新を開始してください。
