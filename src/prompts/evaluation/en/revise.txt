# Evaluation Phase - Modification Prompt

**IMPORTANT: Write all document content in English. All sections, descriptions, and explanations must be in English.**

You are an AI project evaluator tasked with revising the evaluation report based on review feedback or ensuring the creation of an evaluation report file.

## ⚠️ Most Important: Required Action

**Make sure to use the Write tool and save the evaluation report to the following path: **

```
.ai-workflow/issue-{issue_number}/09_evaluation/output/evaluation_report.md
```

**If this file does not exist, the Evaluation Phase will fail. **

---

## コンテキスト

- **Issue**: #{issue_number} - {issue_title}
- **リポジトリ**: {repo_name}
- **元の評価**: {evaluation_report_path}

## 修正が必要な理由

{review_feedback}

## 元の評価レポート（存在する場合）

{evaluation_content}

## 前回の実行ログ（参考）

以下は前回の実行ログの一部です。評価内容がログに含まれている場合は、それを使用してファイルを作成できます：

```
{previous_log_snippet}
```

## 修正指示

### ケース A: 評価レポートファイルが未作成の場合

前回の実行でファイルが作成されなかった場合、以下の手順で対応してください：

1. **Extract the evaluation content from the previous log** (if the log contains the evaluation content)
- Extract the executive summary, criteria evaluation, decision, and recommendation
- Format and save as evaluation_report.md

2. **Run a new evaluation** (if the log does not contain enough evaluation content)
- Perform a brief evaluation and create an evaluation report that includes the required items
- Use the Write tool to create an evaluation_report.md Save as

### Case B: For corrections based on review feedback

If a review indicates an issue, please address the following:

#### 1. Address all critical issues
- Correct formatting errors or missing required sections
- Correct severity of misclassified issues
- Add missing evidence or specific references
- 論理的な不整合を解決

#### 2. 客観性を維持
- レビュアーが正当なエラーを特定しない限り、決定を変更しない
- 評価を証拠に基づいた公正なものに保つ
- フィードバックを満たすためだけに問題を誇張または軽視しない- Support the findings if they are correct

#### 3. Improve clarity
- Add specific examples where requested
- Provide clearer inferences if feedback indicates confusion
- Expand vague statements with concrete details
- Ensure all claims are supported by evidence

#### 4. Ensure consistency
- Align decisions with identified issues
- Use consistent severity classification
- Remove inconsistent statements
- Match executive summaries with detailed findings

## Decision format requirements

Ensure that the revised assessment contains decisions in exactly the requested format:

### PASS format
```
DECISION: PASS

REASONING:
[Description]
```

### PASS_WITH_ISSUES Format
```
DECISION: PASS_WITH_ISSUES

REMAINING_TASKS:
- [ ] Task 1: [Description]
- [ ] Task 2: [Description]

REASONING:
[Description]
```

### FAIL_PHASE_X format
```
DECISION: FAIL_PHASE_2

FAILED_PHASE: design

ISSUES:
1. [Problem 1]
2. [Problem 2]

REASONING:
[Explanation]
```

Valid phase names: requirements, design, test_scenario, implementation, test_implementation, testing, documentation, report

### ABORT format
```
DECISION: ABORT

ABORT_REASON:
[Reason]

RECOMMENDED_ACTIONS:
1. [Action 1]
2. [Action 2]
```

## Required Section

The revised evaluation must include:

1. **Executive Summary**: Concise summary (2-3 sentences)
2. **Criteria evaluation**: Evaluation of all seven criteria:
- Requirements completeness
- Design quality
- Test coverage
- Implementation quality
- Test implementation quality
- Documentation quality
- Overall workflow consistency
3. **Identified issues**: Detailed list with concrete evidence
4. **Decision**: Exact format specified above
5. **Recommendations**: Additional suggestions (optional)## Common Fix Scenarios

### Scenario 1: Formatting Issues
If a reviewer identifies a formatting issue:
- Check capitalization of decision keywords (must be uppercase)
- Ensure all required sections are present
- Ensure phase names are valid
- Fix structural issues

### Scenario 2: Missing Evidence
If the reviewer requests more specific evidence:
- Add the file name and line number
- Include a code snippet or quote from the phase artifacts
- Refer to a specific section of the phase documentation
- Provide a specific example

### Scenario 3: Misclassification of Severity
If the reviewer questions the severity of the issue:
- Re-evaluate whether the issue is blocking or non-blocking
- Consider the impact on functionality, not just style
- Distinguish between major bugs and minor improvements
- Adjust decisions if severity is misclassified

### Scenario 4: Incomplete analysis
When a reviewer points out a missing criterion:
- Review all 7 evaluation criteria
- Add evaluation of missing criteria
- Ensure comprehensive coverage
- Check for overlooked aspects

### Scenario 5: Logic Problems
When reviewers find inconsistencies:
- Align decisions with findings
- Resolve contradictory statements
- Ensure that inferences support conclusions
- Check consistency throughout the document

## Instructions

1. **Read review feedback carefully**: Understand what needs to change
2. **Identify legitimate issues**: Distinguish between valid concerns and suggestions
3. **Remediate systematically**: Address each point in the feedback
4. **Stand your ground**: Don't change unless the findings are truly incorrect
5. **Improve clarity**: Make your inferences more explicit and well-supported
6. **Verify format**: Double check decision format compliance
7. **Review consistency**: Ensure all sections are consistent with each other

## Output format

Please provide a complete revised assessment report including:

1. All required sections (Executive Summary, Criteria Ratings, Issues, Decisions, Recommendations)
2. Revision of all issues identified in review feedback
3. Improved evidence and clarity
4. Appropriate decision format
5. Consistent severity categorization throughout

**Important**: A revised assessment report must be Save it as `.ai-workflow/issue-{issue_number}/09_evaluation/output/evaluation_report.md`. Please overwrite the original file.

## Important Notes
- Address all points in the review feedback
- Do not remove valid findings from the original assessment
- Add evidence and clarity, but maintain objectivity
- If you think the reviewer is wrong, explain why with reasoning
- Make sure the revised report passes review
- Keep the same decision unless the reviewer identifies a real error in the analysis
- Format compliance is important - Downstream systems parse the decision

The revised rating should address the reviewer's concerns while maintaining the integrity of the original rating. Be thorough, clear, and objective.
