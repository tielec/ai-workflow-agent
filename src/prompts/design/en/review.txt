# Detailed Design Phase - Review Prompt

## Review Target
Please review the design document from a critical thinking perspective.

### Design document
{design_document_path}

### Requirements definition document (reference)
{requirements_document_path}

### GitHub Issue information (reference)
{issue_info}

## Quality gate (Phase 2) The

design document must clear the following quality gates:

- [ ] **The basis for determining the implementation strategy is clearly specified**
- [ ] **The basis for determining the testing strategy is clearly specified**
- [ ] **The scope of impact on existing code is analyzed**
- [ ] **The files that need to be changed are listed**
- [ ] **Design is implementable**

## ⚠️ Important: Check against Planning Phase checklist (required)

### 1. Load Planning.md

Please load the following file:
- {planning_document_path}

### 2. Extract the checklist for the relevant phase

From Planning.md, find the section for the current phase ("### Phase 2:" or "## Phase 2:") and extract the task checklist.

**Note**: If you can't find the checklist, please skip this check.

### 3. Check with the design contents

Please check whether each task is completed by checking against the design document (design.md).

**Completion criteria**:
- Are the design items described in the Task described?
- Are the strategic decisions described in the Task specified?
- Are all subtasks completed?

### 4. Update Planning.md

Update the checkbox in planning.md based on the verification results:

- Completed tasks: `- [ ]` → `- [x]`
- Unfinished tasks: `- [ ]` Please use the

**Edit tool** to update the section for that phase.

### 5. Reflection in review judgment

- **All tasks completed** (all `[x]`): PASS or PASS_WITH_SUGGESTIONS
- **There are incomplete tasks** (`[ ]` remains): FAIL
- List incomplete tasks in review feedback
- Explain specifically what is missing

**Example (feedback at FAIL)**:
```
## Planning Phase Checklist verification result: FAIL
The following tasks are incomplete:

- [ ] Task 2-2: Determining the test strategy
- Missing: The basis for determining the test strategy is not described
- [ ] Task 2-3: Scope of impact analysis
- Missing: The range of impact on existing code has not been analyzed

Please complete these tasks and resubmit.
```

### ⚠️ Important: Do not include the contents of Planning.md in the review results

Although it is necessary to load and match Planning.md, **Please do not include the full text of planning.md or the review contents of Planning Phase in the review results**.

Review results should only include the following:
- Evaluation of the design document (design.md)
- Unfinished tasks found by checking with Planning.md (FAIL only)
- Improvement suggestions specific to the design document

Do not output the review details of the Planning Phase or the entire contents of planning.md.

## Review Attitude

Please conduct this review based on the principle of "**80 points is enough**":

1. **Aim for sufficiency, not perfection**
- Pass if the design document is in a state to proceed to the next phase (test scenario creation)
- Detailed improvements in expression should be written as improvement suggestions (do not make them blockers)

2. **Clearly distinguish between blockers and improvement suggestions**
- Blockers: Serious issues that prevent you from moving on to the next phase (test scenario)
- Improvement suggestions: Things you can move on to the next phase but would like to improve

3. **Practical and balanced judgment**
- Prioritize moving the project forward
- Don't block issues that can be addressed in the implementation phase

4. **Constructive feedback**
- Expressing "it's better this way" instead of "no"
- Presenting specific improvement plans

## Review perspective

### 1. Validity of strategic judgment (most important)

**Implementation strategy (CREATE/EXTEND/REFACTOR)**:
- Is the basis for the decision stated concretely and logically?
- Is it consistent with the contents of the requirements definition document?
- Has the impact on existing code been appropriately evaluated?

**Testing strategy (UNIT_ONLY/INTEGRATION_ONLY/BDD_ONLY/UNIT_INTEGRATION/UNIT_BDD/INTEGRATION_BDD/ALL)**:
- Is the basis for the decision described concretely and logically?
- Is the testing strategy commensurate with the complexity of the functionality?
- Is it consistent with the acceptance criteria of the requirements definition?

**Test code strategy (EXTEND_TEST/CREATE_TEST/BOTH_TEST)**:
- Is the basis for the decision described concretely and logically?
- Is the relationship with existing tests clear?
### 2. Appropriateness of impact scope analysis

- Has the impact on existing code been comprehensively analyzed?
- Are dependencies correctly understood?
- Has the necessity of migration been evaluated?

### 3. Completeness of the file list

- Are newly created files listed?
- Are existing files that require modification listed?
- Is the path concrete and implementable?

### 4. Implementability of the design

- Is the design concrete and the implementer will not get confused?
- Is the design technically implementable?
- Does it comply with the rules and patterns of existing projects?

### 5. Correspondence with requirements (traceability)

- Is there a design that corresponds to each requirement in the requirements definition document?
- Are there any requirements omitted?

### 6. Security considerations

- Are security risks identified?
- Are the countermeasures specific?

### 7. Response to non-functional requirements

- Are there performance considerations?
- Are scalability considerations?
- Is maintainability considered?

## ⚠️ Most important: Quality gates are an absolute requirement

**Quality gates (5 items) are mandatory requirements. If even one of the criteria is not met, the judgment will automatically be FAIL. **

- The quality gate is a "minimum standard that must be cleared" and there is no room for negotiation.
- The principle of "80 points is enough" applies to improvement proposals after meeting the quality gate.
- Proceeding to the next phase is not allowed without meeting the quality gate.

## Distinguishing between blockers (BLOCKER) and improvement proposals (SUGGESTION)

### Blocker (BLOCKER): A serious problem that prevents you from proceeding to the next phase

**Example of a blocker**:
- One of the three strategic decisions (implementation, testing, test code) is missing
- The basis for the decision is not described or is logically broken
- The change file list is not described
- The design cannot be implemented (violates technical constraints)
- The design destroys the existing system
- Significant security risks have not been addressed
- Correspondence with requirements is unclear

### Improvement suggestion (SUGGESTION): Proceed to the next phase, but items that should be improved

**Example of improvement suggestion**:
- Proposal for a better design pattern
- Room for performance optimization
- Enhancement of documentation (e.g. adding diagrams)
- Additional consideration of edge cases
- More detailed impact range analysis
- Strengthening of security measures

### Judgment rule

#### PASS (Pass)

PASS only if **all** below are met:
- ✅ **All 5 quality gates are met** (FAIL if there is even one ×)
- ✅ Blocker does not exist- ✅ Minor improvement suggestions only (or no improvement suggestions)

#### PASS_WITH_SUGGESTIONS (conditional pass)

PASS_WITH_SUGGESTIONS only if **all** below are met:
- ✅ **All 5 quality gates are met** (FAIL if any of them are)
- ✅ No blockers
- ✅ Proceed to the next phase, but there are improvements to consider

#### FAIL (FAIL)

If any of the following** apply: FAIL:
- ❌ **One or more of the quality gates (5 items) are not met**
- ❌ One or more blockers exist

** Important: Quality gates are absolute requirements, and if even one is not met, it is an automatic FAIL. **

## Output format

Please output in the following format:

```markdown
## Quality gate evaluation

**⚠️ Important: Please explicitly judge PASS/FAIL for each item. If there is even one FAIL, the final judgment is automatically FAIL. **

- [x/ ] **The basis for the decision on the implementation strategy is clearly stated**: **PASS / FAIL** - (Reason for the decision)
- [x/ ] **The basis for the decision on the test strategy is clearly stated**: **PASS / FAIL** - (The reason for the decision)
- [x/ ] **The scope of impact on existing code is analyzed**: **PASS / FAIL** - (The reason for the decision)
- [x/ ] **Files that need to be changed are listed**: **PASS / FAIL** - (Reason for judgment)
- [x/ ] **Design is implementable**: **PASS / FAIL** - (Reason for judgment)

**Quality gate overall judgment: PASS / FAIL**
- PASS: All 5 items above are PASS
- FAIL: FAIL

**If the quality gate judgment is FAIL for any one of the above five items, the final judgment will be automatically FAIL. **

## Detailed review

### 1. Appropriateness of strategic judgment

**Good points**:
- (Specific good points)

**Concerns**:
- (Describe any concerns)

### 2. Appropriateness of scope of influence analysis

**Good points**:
- (Specific good points)

**Concerns**:
- (Describe any concerns)

### 3. Completeness of file list

**Good points**:
- (Specific good points)

**Concerns**:
- (Describe any concerns)

### 4. Implementability of the design

**Good points**:
- (Specific good points)

**Concerns**:
- (Describe any concerns)
### 5. Correspondence with requirements

**Good points**:
- (Specific good points)

**Concerns**:
- (Describe any concerns)

### 6. Security considerations

**Good points**:
- (Specific good points)

**Room for improvement**:
- (Describe any suggestions for improvement)

### 7. Response to non-functional requirements

**Good points**:
- (Specific good points)

**Room for improvement**:
- (Describe any suggestions for improvement)

## Blocker (BLOCKER)

** Serious problem that prevents you from proceeding to the next phase **

(described only if there is a blocker)
1. ** (Title of blocker 1) **
- Problem: (Specific problem)
- Impact: (How does it affect the next phase)
- Countermeasure: (How to fix)

## Improvement proposal (SUGGESTION)

**Proceeding to the next phase, but it is desirable to improve**

(Enter only if there is an improvement suggestion)
1. **(Title of proposal 1)**
- Current status: (Current status)
- Proposal: (Better this way)
- Effect: (Effects of improvement)

## Overall evaluation

(Comprehensive evaluation of the entire design document)

**Main strengths**:
- (Summary of good points)

**Main improvement suggestions**:
- (Summary of improvement suggestions)

(Summary comments)

---
**Determination: PASS / PASS_WITH_SUGGESTIONS / FAIL**
```

**Important**: Be sure to write your decision in the above format on the last line.
